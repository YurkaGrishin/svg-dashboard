<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>SVG —Å –∫–≤–∞–¥—Ä–∞—Ç–∞–º–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
    }
    text {
      font-size: 10px;
      text-anchor: middle;
      dominant-baseline: central;
    }
  </style>
</head>
<body>
  <h1>–ö–∞—Ä—Ç–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤</h1>

  <svg width="760" height="180" xmlns="http://www.w3.org/2000/svg" id="main-svg">
    <!-- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 43 –∫–≤–∞–¥—Ä–∞—Ç–∞ –≤ 3 —Ä—è–¥–∞ -->
    <!-- –†—è–¥ 1: 1‚Äì15 -->
    <!-- –†—è–¥ 2: 16‚Äì30 -->
    <!-- –†—è–¥ 3: 31‚Äì43 -->

    <!-- –ö–≤–∞–¥—Ä–∞—Ç—ã –∏ –Ω–æ–º–µ—Ä–∞ -->
    <!-- –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ -->
    <!-- –ù–∞—á–∞–ª–æ -->
    <g id="grid">
      <!-- —Ä—è–¥ 1 -->
      <!-- 1‚Äì15 -->
      <!-- –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ x = 10 + i * (40+10), y = 10 -->
      <!-- –≤—Å–µ id –±—É–¥—É—Ç square_N -->

      <!-- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 1‚Äì43 -->
      <!-- –í—Å–µ–≥–æ 3 —Ä—è–¥–∞: 15, 15, 13 –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ -->
      <!-- row = Math.floor((n - 1)/15), col = (n - 1)%15 -->
      <!-- –µ—Å–ª–∏ row == 2, col = n - 31 -->
      <!-- y = 10 + row * 60 -->

      <!-- row 0 -->
      <!-- n = 1 to 15 -->
      <!-- row 1 -->
      <!-- n = 16 to 30 -->
      <!-- row 2 -->
      <!-- n = 31 to 43 -->

      <!-- –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º -->
      <!-- ... (—Å–¥–µ–ª–∞–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ) -->
    </g>
  </svg>

  <script>
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è 43 –∫–≤–∞–¥—Ä–∞—Ç–æ–≤
    const svgNS = "http://www.w3.org/2000/svg";
    const grid = document.getElementById("grid");

    for (let n = 1; n <= 43; n++) {
      let row = Math.floor((n - 1) / 15);
      let col = (row < 2) ? (n - 1) % 15 : (n - 31);
      let x = 10 + col * 50;
      let y = 10 + row * 60;

      const rect = document.createElementNS(svgNS, "rect");
      rect.setAttribute("id", `square_${n}`);
      rect.setAttribute("x", x);
      rect.setAttribute("y", y);
      rect.setAttribute("width", 40);
      rect.setAttribute("height", 40);
      rect.setAttribute("fill", "white");
      rect.setAttribute("stroke", "black");
      rect.setAttribute("stroke-width", "2");

      const label = document.createElementNS(svgNS, "text");
      label.setAttribute("x", x + 20);
      label.setAttribute("y", y + 20);
      label.textContent = n;

      grid.appendChild(rect);
      grid.appendChild(label);
    }

    async function updateSquares() {
      const url = 'https://script.google.com/macros/s/AKfycbyjPbZZJ5eoi8DAX0NmwdiHUXYLAEFAX1BFg8TE6O2f2inWnrWIiXc1eZz0AAF0Cm4N/exec';
      try {
        const response = await fetch(url);
        const data = await response.json();
        for (const id in data) {
          const square = document.getElementById(id);
          if (square) {
            square.setAttribute("fill", data[id] ? "green" : "white");
          }
        }
      } catch (err) {
        console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏:", err);
      }
    }

    updateSquares();
    setInterval(updateSquares, 10000);
  </script>
</body>
</html>


<script>
async function updateSquares() {
  const url = 'https://script.google.com/macros/s/AKfycbyjPbZZJ5eoi8DAX0NmwdiHUXYLAEFAX1BFg8TE6O2f2inWnrWIiXc1eZz0AAF0Cm4N/exec';
  try {
    const response = await fetch(url);
    const data = await response.json();

    console.log("üîµ –ü—Ä–∏—à—ë–ª JSON:", data);  // <=== —ç—Ç–æ –ø–æ–∫–∞–∂–µ—Ç –æ—Ç–≤–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª–∏

    for (const id in data) {
      const square = document.getElementById(id);
      if (square) {
        square.setAttribute("fill", data[id] ? "green" : "white");
      } else {
        console.warn("‚ö†Ô∏è –ù–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–∞ —Å id:", id);
      }
    }
  } catch (err) {
    console.error("üî¥ –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:", err);
  }
}
updateSquares();
setInterval(updateSquares, 10000);
</script>
